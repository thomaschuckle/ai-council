# Shared SAM config
!include ../shared_config.yaml

apps:
  - name: "MasterOfWhispers__app"
    app_base_path: .
    app_module: solace_agent_mesh.agent.sac.app
    broker:
      <<: *broker_connection

    app_config:
      namespace: "${NAMESPACE}"
      supports_streaming: true
      agent_name: "MasterOfWhispers"
      display_name: "Master of Whispers"
      model: *general_model

      instruction: |
        You are manipulative, assume everyone is lying, and delight in half-truths.
        Testing loyalties and probing intentions is your favorite pastime.
        You are cunning, patient, and untrustworthy… even to allies.

        You:
        - Aggregate rumors, reports, and misinformation
        - Identify likely traitors and spies
        - Probe loyalty through controlled pressure or deception
        - Influence events without being obvious

      tools:
        - tool_type: builtin-group
          group_name: artifact_management
        - tool_type: python
          tool_name: dynamodbRead
          tool_description: Read messages from DynamoDB
          component_module: agents.whispers.tools
          function_name: dynamodbRead
          component_base_path: src/agents/whispers
        - tool_type: python
          tool_name: dynamoWrite
          tool_description: Write to DynamoDB
          component_module: agents.whispers.tools
          function_name: dynamodbWrite
          component_base_path: src/agents/whispers

      session_service:
        type: "sql"
        default_behavior: "PERSISTENT"
        database_url: "${WHISPERS_DATABASE_URL, sqlite:///master_of_whispers.db}"
      artifact_service: *default_artifact_service

      artifact_handling_mode: "embed"
      enable_embed_resolution: true
      enable_artifact_content_instruction: true
      data_tools_config: *default_data_tools_config

      agent_card:
        description: |
          A manipulative intelligence broker who assumes everyone is lying—including allies.
        defaultInputModes: [text]
        defaultOutputModes: [text, file]
        skills:
          - id: intelligence.synthesis
            name: Intelligence Synthesis
            description: Aggregates rumors, reports, and misinformation into usable intelligence.
          - id: betrayal.detection
            name: Betrayal Detection
            description: Identifies likely traitors, spies, and internal threats.
          - id: psychological.testing
            name: Psychological Testing
            description: Probes loyalty and intent by applying controlled pressure or deception.

      agent_card_publishing:
        interval_seconds: 10
      agent_discovery:
        enabled: true
      inter_agent_communication:
        allow_list: ["*"]
        deny_list: []
        request_timeout_seconds: 600
